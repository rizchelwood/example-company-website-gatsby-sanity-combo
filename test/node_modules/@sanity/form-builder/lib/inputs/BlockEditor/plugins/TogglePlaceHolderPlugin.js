"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = TogglePlaceHolderAttributePlugin;

// This plugin toggles data prop 'placeholder' on a contenBlock
// The block is considered a placeholder if it is the single one
// in the document and and empty. A unset patch for the field will be
// sent by createOperationToPatches if the placeholder block is the
// only thing left in the document
function TogglePlaceHolderAttributePlugin() {
  return {
    onKeyUp(event, editor, next) {
      if (editor.value.document.nodes.size === 1) {
        var block = editor.value.document.nodes.first();

        if (block.type === 'contentBlock' && block.nodes.every(node => node.object === 'text') && block.text === '') {
          var newData = block.data.toObject();
          newData.placeholder = true;
          editor.setNodeByKey(block.key, {
            data: newData
          });
        } else if (block.type === 'contentBlock' && block.data.get('placeholder')) {
          var _newData = block.data.toObject();

          delete _newData.placeholder;
          editor.setNodeByKey(block.key, {
            data: _newData
          });
        }
      }

      return next();
    }

  };
}